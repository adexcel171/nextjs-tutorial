{"version":3,"sources":["../../src/server/web-server.ts"],"names":["byteLength","BaseServer","NoFallbackError","generateETag","addRequestMeta","WebResponseCache","isAPIRoute","getPathMatch","getRouteFromAssetPath","normalizeLocalePath","removeTrailingSlash","isDynamicRoute","interpolateDynamicPath","normalizeVercelUrl","getNamedRouteRegex","IncrementalCache","NextWebServer","constructor","options","Object","assign","renderOpts","webServerConfig","extendRenderOpts","handleCompression","getIncrementalCache","requestHeaders","dev","requestProtocol","appDir","hasAppDir","allowedRevalidateHeaderKeys","nextConfig","experimental","minimalMode","fetchCache","fetchCacheKeyPrefix","maxMemoryCacheSize","isrMemoryCacheSize","flushToDisk","CurCacheHandler","serverOptions","incrementalCacheHandler","getPrerenderManifest","getResponseCache","getCustomRoutes","headers","rewrites","fallback","afterFiles","beforeFiles","redirects","run","req","res","parsedUrl","hasPage","page","getPublicDir","getBuildId","buildId","loadEnvConfig","getHasAppDir","pagesType","getHasStaticDir","getFallback","getFontManifest","undefined","getPagesManifest","getAppPathsManifest","getFilesystemPaths","Set","attachRequestMeta","query","prerenderManifest","version","routes","dynamicRoutes","notFoundRoutes","preview","previewModeId","getServerComponentManifest","clientReferenceManifest","getServerCSSManifest","serverCSSManifest","getNextFontManifest","nextFontManifest","generateRoutes","fsRoutes","match","type","name","check","fn","params","_parsedUrl","path","render404","finished","shift","lastParam","length","endsWith","pathname","join","router","hasMiddleware","trailingSlash","substring","i18n","host","hostname","split","toLowerCase","localePathResult","locales","domainLocale","i18nProvider","detectDomainLocale","detectedLocale","__nextLocale","__nextDefaultLocale","defaultLocale","__nextDataReq","_params","catchAllRoute","matchesLocale","Error","routeRegex","keys","routeKeys","analyze","bubbleNoFallback","_nextBubbleNoFallback","render","err","useFileSystemPublicRoutes","appPathRoutes","getAppPathRoutes","catchAllMiddleware","matchers","handleApiRequest","renderHTML","pagesRenderToHTML","appRenderToHTML","curRenderToHTML","disableOptimizedLoading","runtime","sendRenderResult","_req","setHeader","poweredByHeader","resultContentType","result","contentType","getHeader","isDynamic","writer","transformStream","writable","getWriter","pipe","write","chunk","end","close","destroy","abort","cork","uncork","payload","toUnchunkedString","String","generateEtags","body","send","runApi","findPageComponents","loadComponent","components"],"mappings":"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"}